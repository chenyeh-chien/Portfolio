---
title: "HTTPS and TLS"
date: "2025-12-01"
description: "HTTPS and TLS"
tags: ["https", "tls", "ssl"]
cover: "/og/https-and-tls.png"
category: "Security"
---

****
### ⭐ HTTP vs HTTPS
| 特性	| HTTP (HyperText Transfer Protocol)	| HTTPS (HTTP over SSL/TLS) |
| --- | --- | --- |
| 安全性	| 不安全。資料以明文傳輸。 | 安全。資料經過加密傳輸。 |
| 預設埠號 (Port)	| 80 | 443 |
| 身分驗證	| 無。無法確認伺服器真實性。 | 有。透過數位憑證確認伺服器身分。 |
| 資料完整性	| 無。資料在傳輸中可能被篡改。 | 有。透過 MAC 演算法確保資料未被變動。 |
| 費用	| 免費。 | 需要購買或申請 SSL 憑證（目前有免費方案）。 |

****
### 啟用 HTTPS 的實作流程
要讓網站從 http:// 變成 https://，通常需要經過以下五個步驟：

#### 第一步：選擇憑證頒發機構 (CA)
- 免費方案 (推薦)：Let's Encrypt。這是目前全球最受歡迎的方案，透過自動化工具 (Certbot) 即可申請，缺點是每 90 天需續期一次（但通常設為自動續期）。
- 付費方案：如 DigiCert、Sectigo。提供更高額的保險補償金，以及針對企業身分驗證的 OV (Organization Validated) 或 EV (Extended Validation) 憑證。

#### 第二步：產生 CSR (憑證簽署請求)
在你的伺服器上產生一對密鑰：私鑰 (Private Key) 與 公鑰 (Public Key)。
- 你會將公鑰與你的網域資訊包裝成一個 CSR 檔案 傳送給 CA。
- 注意：私鑰絕對不能流出，它是加解密的關鍵。

#### 第三步：驗證網域所有權 (Domain Validation)
CA 必須確認該網域真的是你的。常見驗證方式：
- HTTP 驗證：在你的網頁目錄放一個特定的檔案，讓 CA 抓取。
- DNS 驗證：在網域設定中新增一筆指定的 TXT 紀錄（這對於申請萬用字元憑證 *.example.com 是必須的）。

#### 第四步：取得並安裝憑證
驗證通過後，CA 會核發憑證檔案（通常是 .crt 或 .pem）。
- 你需要將這些檔案配置到 Web Server（如 Nginx 或 Apache）中。

#### 第五步：強制跳轉 (Redirect)
設定伺服器將所有不安全的 HTTP 請求（Port 80）自動導向 HTTPS（Port 443）。

****
### TLS 加解密運作機制（Handshake 握手流程）
TLS 的精妙之處在於它不直接用緩慢的非對稱加密來傳輸數據，而是用它來「安全地交換」一個快速的對稱金鑰。

步驟分解：
1. Client Hello：瀏覽器傳送支援的 TLS 版本和「加密演算法清單」。
2. Server Hello：伺服器選定一個演算法，並回傳自己的 數位憑證 (Certificate)（內含伺服器的 公鑰）。
3. 驗證憑證：瀏覽器檢查該憑證是否由受信任的 CA 機構核發。
4. 密鑰交換 (Pre-Master Secret)：
    - 瀏覽器產生一個隨機數（預主密鑰）。
    - 用伺服器的 公鑰 加密後傳給伺服器。
5. 產生對稱金鑰：雙方利用這個隨機數產生相同的 對稱金鑰 (Session Key)。
6. 加密傳輸：之後所有的資料都使用這個對稱金鑰進行加密。

****
### 安全性的三大支柱 (CIA)
HTTPS 透過 TLS (傳輸層安全性) 協定，為原本的 HTTP 穿上了一層保護殼，提供了三大安全保證：
#### A. 機密性 (Confidentiality) — 加密
在 HTTP 下，如果你在公共 Wi-Fi 登入網站，黑客可以使用「嗅探 (Sniffing)」工具直接看到你的帳號密碼。而 HTTPS 會對資料進行加密，即便黑客攔截到封包，也只能看到一串毫無意義的亂碼。

#### B. 完整性 (Integrity) — 防篡改
HTTP 傳輸中，中間人（如惡意的電信業者或路由器）可以偷偷修改你的網頁內容（例如強行插入廣告）。HTTPS 具有數位簽章機制，只要資料被變動過，瀏覽器就會立即偵測到並中斷連線。

#### C. 身分驗證 (Authentication) — 防偽造
HTTPS 要求伺服器必須持有 SSL/TLS 憑證。這能確保你連線的是「真正的銀行網站」，而不是黑客架設的「釣魚網站」。

